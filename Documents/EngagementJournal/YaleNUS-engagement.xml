<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<?asciidoc-toc?>
<?asciidoc-numbered?>

<article lang="en">
<articleinfo>
    <title>YaleNUS - YaleNUS Cloudforms and OpenStack Implementation - APAC</title>
</articleinfo>
<section id="_document_information">
<title>Document Information</title>
<section id="_originator">
<title>Originator</title>
<simpara>Red Hat Consulting</simpara>
<simpara>Hwee Ming - Principal Architect &lt;<ulink url="mailto:hwng@redhat.com">hwng@redhat.com</ulink>&gt;</simpara>
<simpara>George Goh &lt;<ulink url="mailto:ggoh@redhat.com">ggoh@redhat.com</ulink>&gt;</simpara>
</section>
<section id="_owner">
<title>Owner</title>
<simpara>Red Hat Consulting – Confidential. Restricted distribution.</simpara>
</section>
<section id="_copyright">
<title>Copyright</title>
<simpara>This document contains proprietary information which is for exclusive use of Red Hat, Inc. and is not to be shared with personnel other than Red Hat, Inc.  This document, and any portion thereof, may not be copied, reproduced, photocopied, stored electronically on a retrieval system, or transmitted without the express written consent of the owner.</simpara>
<simpara>Red Hat Professional Services does not warrant this document to be free of errors or omissions.  Red Hat Professional Services reserves the right to make corrections, updates, revisions, or changes to the information contained herein.  Red Hat Professional Services does not warrant the material described herein to be free of patent infringement.</simpara>
<simpara>Unless provided otherwise in writing by RED HAT Professional Services, the information and programs described herein are provided “as is” without warranty of any kind, including but not limited to the implied warranties of merchantability and fitness for a particular purpose. In no event will RED HAT Professional Services, its officers, directors, or employees or affiliates of RED HAT Professional Services, their respective officers, directors, or employees be liable to any entity for any special, collateral, incidental, or consequential damages, including without any limitation, for any lost profits or lost savings, related or arising in any way from or out of the use or inability to use the information or programs set forth herein, even if it has been notified of the possibility of such damage by the purchaser or any third party.</simpara>
</section>
<section id="_distribution">
<title>Distribution</title>
<simpara>Do not forward or copy without written permission.</simpara>
<simpara>Copies of this document are restricted to the following:</simpara>
<simpara>Red Hat, Inc.</simpara>
<simpara>YaleNUS</simpara>
</section>
<section id="_confidentiality">
<title>Confidentiality</title>
<simpara>All information supplied to YaleNUS for the purpose of this project is to be considered Red Hat confidential.</simpara>
</section>
<section id="_additional_copies">
<title>Additional copies</title>
<simpara>Further copies of this document can be obtained from:</simpara>
<simpara>Hwee Ming<?asciidoc-br?>
George Goh</simpara>
<simpara><?asciidoc-pagebreak?></simpara>
</section>
<section id="_points_of_contact">
<title>Points of Contact</title>
<table
frame="all"
rowsep="1" colsep="1"
>
<title>YaleNUS Contact Information</title>
<?dbhtml table-width="100%"?>
<?dbfo table-width="100%"?>
<?dblatex table-width="100%"?>
<tgroup cols="3">
<colspec colname="col_1" colwidth="142*"/>
<colspec colname="col_2" colwidth="142*"/>
<colspec colname="col_3" colwidth="142*"/>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Wallace Tan</simpara></entry>
<entry align="left" valign="top"><simpara><ulink url="mailto:wallace.tan@yale-nus.edu.sg">wallace.tan@yale-nus.edu.sg</ulink></simpara></entry>
<entry align="left" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Darwin</simpara></entry>
<entry align="left" valign="top"><simpara><ulink url="mailto:darwin.gosal@yale-nus.edu.sg">darwin.gosal@yale-nus.edu.sg</ulink></simpara></entry>
<entry align="left" valign="top"><simpara></simpara></entry>
</row>
</tbody>
</tgroup>
</table>
<table
frame="all"
rowsep="1" colsep="1"
>
<title>Red Hat Contact Information</title>
<?dbhtml table-width="100%"?>
<?dbfo table-width="100%"?>
<?dblatex table-width="100%"?>
<tgroup cols="3">
<colspec colname="col_1" colwidth="142*"/>
<colspec colname="col_2" colwidth="142*"/>
<colspec colname="col_3" colwidth="142*"/>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Lester Claudio</simpara></entry>
<entry align="left" valign="top"><simpara><ulink url="mailto:lester@redhat.com">lester@redhat.com</ulink></simpara></entry>
<entry align="left" valign="top"><simpara>+1-719-331-0726</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Hwee Ming</simpara></entry>
<entry align="left" valign="top"><simpara></simpara></entry>
<entry align="left" valign="top"><simpara></simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>George Goh</simpara></entry>
<entry align="left" valign="top"><simpara><ulink url="mailto:george.goh@redhat.com">george.goh@redhat.com</ulink></simpara></entry>
<entry align="left" valign="top"><simpara>+65-6490-4744</simpara></entry>
</row>
</tbody>
</tgroup>
</table>
</section>
<section id="_deliverables">
<title>Deliverables</title>
<section id="_task_list">
<title>Task List</title>
<section id="_red_hat_cloudforms_implementation_tasks">
<title>Red Hat Cloudforms Implementation tasks:</title>
</section>
<section id="_red_hat_openstack_implementation_tasks">
<title>Red Hat OpenStack Implementation tasks:</title>
</section>
</section>
</section>
</section>
<section id="_project_approach">
<title>Project Approach</title>
<section id="_introduction">
<title>Introduction</title>
<simpara>Yale-NUS College, a residential college located in Singapore, aims to redefine liberal arts and science education for a complex, interconnected world.</simpara>
<itemizedlist>
<listitem>
<simpara>
A community of learning
</simpara>
</listitem>
</itemizedlist>
<simpara>We are a diverse group of students, faculty, staff, and supporters, dedicated to building a community in which living and learning are intertwined and habits of creativity, curiosity, and critical thinking are encouraged. Our innovative curriculum integrates knowledge from across the disciplines and around the world.</simpara>
<itemizedlist>
<listitem>
<simpara>
Founded by two great universities
</simpara>
</listitem>
</itemizedlist>
<simpara>An intimate liberal arts college, dedicated to undergraduate education, Yale-NUS draws on the resources and traditions of two great universities. We pursue excellence through innovative teaching and research, and we provide global opportunities for our students.</simpara>
<itemizedlist>
<listitem>
<simpara>
In Asia
</simpara>
</listitem>
</itemizedlist>
<simpara>Our location at the crossroads of Asia informs our pedagogy. Drawing on active modes of learning associated with American liberal arts education, we introduce our students to the diverse intellectual traditions and cultures of Asia and the world.</simpara>
<itemizedlist>
<listitem>
<simpara>
For the world
</simpara>
</listitem>
</itemizedlist>
<simpara>We educate citizens of the world and uphold the principles of free exchange of ideas, pluralism, and respect for diversity. Our extra-curricular and residential programmes support student learning and encourage an ethic of service. By our example, we seek to spur innovation in higher education across the globe.</simpara>
<simpara>Red Hat Consulting was engaged by the infrasturecture at Yale NUS to assist in deploying CloudForms 3.1 (Red Hat CloudForms Management Engine, CFME), integrate Cloudforms with Amazon Web Services (AWS), and deploy Red Hat OpenStack in their current infrastructure.</simpara>
<simpara>This document details the strategies, implementations, and recommendations that Red Hat Consulting services provided for YaleNUS in Singapore, Singapore.</simpara>
</section>
<section id="_architecture_overview">
<title>Architecture Overview</title>
<simpara>Cloudforms is a powerful tool that allows customers to build and manage their current virtualization environment
as well as their future private or hybrid cloud.  The Red Hat CloudForms 3 “Management Engine” delivers the
insight, control, and automation enterprises need in order to manage diverse and expanding virtual environments.
This technology enables enterprises with existing virtual infrastructures to improve visibility and control, and
those just starting virtualization deployments to build and operate a well-managed virtual infrastructure.</simpara>
</section>
<section id="_network_details_for_yalenus">
<title>Network Details for YaleNUS</title>
<section id="_hostnames_ip_addresses">
<title>Hostnames / IP Addresses</title>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<?dbhtml table-width="100%"?>
<?dbfo table-width="100%"?>
<?dblatex table-width="100%"?>
<tgroup cols="6">
<colspec colname="col_1" colwidth="105*"/>
<colspec colname="col_2" colwidth="63*"/>
<colspec colname="col_3" colwidth="63*"/>
<colspec colname="col_4" colwidth="63*"/>
<colspec colname="col_5" colwidth="55*"/>
<colspec colname="col_6" colwidth="76*"/>
<thead>
<row>
<entry align="left" valign="top"> Host      </entry>
<entry align="left" valign="top">   IP Address </entry>
<entry align="left" valign="top"> Netmask </entry>
<entry align="left" valign="top"> Gateway </entry>
<entry align="left" valign="top"> DNS Server </entry>
<entry align="left" valign="top"> Notes</entry>
</row>
</thead>
<tbody>
</tbody>
</tgroup>
</informaltable>
</section>
<section id="_vlans_allocated">
<title>VLANs Allocated</title>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<?dbhtml table-width="100%"?>
<?dbfo table-width="100%"?>
<?dblatex table-width="100%"?>
<tgroup cols="6">
<colspec colname="col_1" colwidth="71*"/>
<colspec colname="col_2" colwidth="71*"/>
<colspec colname="col_3" colwidth="71*"/>
<colspec colname="col_4" colwidth="71*"/>
<colspec colname="col_5" colwidth="71*"/>
<colspec colname="col_6" colwidth="71*"/>
<thead>
<row>
<entry align="left" valign="top"> VLAN ID </entry>
<entry align="left" valign="top"> Purpose </entry>
<entry align="left" valign="top"> Subnet </entry>
<entry align="left" valign="top"> Netmask </entry>
<entry align="left" valign="top"> Gateway </entry>
<entry align="left" valign="top"> Default Gateway</entry>
</row>
</thead>
<tbody>
</tbody>
</tgroup>
</informaltable>
<section id="_vlan_xxx_purpose">
<title>VLAN XXX: Purpose</title>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<?dbhtml table-width="60%"?>
<?dbfo table-width="60%"?>
<?dblatex table-width="60%"?>
<tgroup cols="2">
<colspec colname="col_1" colwidth="128*"/>
<colspec colname="col_2" colwidth="128*"/>
<thead>
<row>
<entry align="left" valign="top"> Hostname </entry>
<entry align="left" valign="top"> IP</entry>
</row>
</thead>
<tbody>
</tbody>
</tgroup>
</informaltable>
<simpara><?asciidoc-pagebreak?></simpara>
</section>
<section id="_vlan_804_management_network">
<title>VLAN 804: Management Network</title>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<?dbhtml table-width="60%"?>
<?dbfo table-width="60%"?>
<?dblatex table-width="60%"?>
<tgroup cols="2">
<colspec colname="col_1" colwidth="128*"/>
<colspec colname="col_2" colwidth="128*"/>
<thead>
<row>
<entry align="left" valign="top"> Hostname </entry>
<entry align="left" valign="top"> IP</entry>
</row>
</thead>
<tbody>
</tbody>
</tgroup>
</informaltable>
</section>
<section id="_vlan_805_storage_network">
<title>VLAN 805: Storage Network</title>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<?dbhtml table-width="60%"?>
<?dbfo table-width="60%"?>
<?dblatex table-width="60%"?>
<tgroup cols="2">
<colspec colname="col_1" colwidth="128*"/>
<colspec colname="col_2" colwidth="128*"/>
<thead>
<row>
<entry align="left" valign="top"> Hostname </entry>
<entry align="left" valign="top"> IP</entry>
</row>
</thead>
<tbody>
</tbody>
</tgroup>
</informaltable>
</section>
</section>
</section>
</section>
<section id="_activities">
<title>Activities</title>
<section id="_issue_status">
<title>Issue status</title>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<?dbhtml table-width="100%"?>
<?dbfo table-width="100%"?>
<?dblatex table-width="100%"?>
<tgroup cols="2">
<colspec colname="col_1" colwidth="383*"/>
<colspec colname="col_2" colwidth="43*"/>
<thead>
<row>
<entry align="left" valign="top"> Issue </entry>
<entry align="left" valign="top"> Resolved?</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>AWS Cloudforms Provisioning</simpara></entry>
<entry align="left" valign="top"><simpara>Y</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Data Center move</simpara></entry>
<entry align="left" valign="top"><simpara>Y</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Fibre Optic hardware compatibility</simpara></entry>
<entry align="left" valign="top"><simpara>N</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>OpenStack Cloudforms Provisioning</simpara></entry>
<entry align="left" valign="top"><simpara>N</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
</section>
<section id="_lester_claudio_8217_s_activity_log">
<title>Lester Claudio&#8217;s activity log</title>
<itemizedlist>
<listitem>
<simpara>
Instance tagging is done.  We need to discuss how I came up with the use case.
</simpara>
</listitem>
<listitem>
<simpara>
reated an example Group and Role taxonomy that we will need to show Yale NUS to see if it works for them.
</simpara>
</listitem>
<listitem>
<simpara>
Sample groups created in support of YaleNUS Self-Service:
</simpara>
<itemizedlist>
<listitem>
<simpara>
YaleNUS-Admin - Basic YaleNUS Administrator group. Will have superuser capabilities.
</simpara>
</listitem>
<listitem>
<simpara>
YaleNUS-&lt;Project&gt; - User group to be associated with their current project.
</simpara>
</listitem>
<listitem>
<simpara>
YaleNUS-&lt;Project&gt;-Admin - This is the Project Administrator &#8230; Professor.
    Unfortunately we will have to have one of these for each project/course.  The group needs to be created in MS AD and the administrator will import it into Cloudforms.
</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>
Added the EBS dialogs and buttons.
</simpara>
</listitem>
<listitem>
<simpara>
Rake scripts to import/export dialogs, buttons, service_dialogs etc
</simpara>
</listitem>
</itemizedlist>
</section>
<section id="_george_goh_8217_s_activity_log">
<title>George Goh&#8217;s activity log</title>
<itemizedlist>
<listitem>
<simpara>
Added BuildRequest method for OpenStack provisioning. This adds the ability to provision more than 1 VM in a request.
</simpara>
</listitem>
<listitem>
<simpara>
Previously created tags/groups to represent projects in Yale-NUS. This was done on request of Yale-NUS due to their lack of control over the corporate(NUS) AD administration. However, integration with projects can be made more seamless if this can be modified in AD. We will need to discuss with Yale-NUS further on this.
</simpara>
</listitem>
<listitem>
<simpara>
Set up the Development machine for OpenStack on <ulink url="http://172.18.17.226">http://172.18.17.226</ulink> while issues with the target production hardware are being resolved.
</simpara>
</listitem>
<listitem>
<simpara>
Set up the Development CloudForms appliance on the dev OpenStack machine on <ulink url="https://172.18.17.126/">https://172.18.17.126/</ulink>. Accounts for AWS and the dev OpenStack machine, as well as Yale-NUS AD connections were set up on this instance.
</simpara>
</listitem>
<listitem>
<simpara>
Previously added Cinder volume functionality. Will need to revisit this to achieve parity with Lester&#8217;s work.
</simpara>
</listitem>
</itemizedlist>
</section>
</section>
<section id="_yalenus_cloudforms_environment">
<title>YaleNUS Cloudforms Environment</title>
<section id="_overview">
<title>Overview</title>
<simpara>TODO</simpara>
</section>
<section id="_pre_requisites">
<title>Pre-requisites</title>
<itemizedlist>
<listitem>
<simpara>
Web Browsers:
</simpara>
<itemizedlist>
<listitem>
<simpara>
Mozilla Firefox for versions supported under Mozilla&#8217;s Extended Support Release (ESR)
</simpara>
</listitem>
<listitem>
<simpara>
Internet Explorer 8 or Higher
</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>
Adobe Flash Player 9 or above.
</simpara>
</listitem>
<listitem>
<simpara>
The Cloudforms Management Engine Appliance must already be installed and activated in your enterprise.
</simpara>
</listitem>
<listitem>
<simpara>
The SmartProxy must have visibility to the virtual machines and cloud instances that you want to control.
</simpara>
</listitem>
<listitem>
<simpara>
Server Racked, Stacked and Cabled
</simpara>
</listitem>
<listitem>
<simpara>
Switch configuration completed
</simpara>
</listitem>
</itemizedlist>
</section>
<section id="_cloudform_appliance_version">
<title>Cloudform Appliance Version</title>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<?dbhtml table-width="100%"?>
<?dbfo table-width="100%"?>
<?dblatex table-width="100%"?>
<tgroup cols="2">
<colspec colname="col_1" colwidth="213*"/>
<colspec colname="col_2" colwidth="213*"/>
<tbody>
<row>
<entry align="left" valign="top"><simpara>OS Version</simpara></entry>
<entry align="left" valign="top"><simpara>RHEL 6.6 x86_64</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>Cloudforms Version</simpara></entry>
<entry align="left" valign="top"><simpara>Cloudforms 3.1</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
</section>
<section id="_yalenus_cloudforms_architecture">
<title>YaleNUS Cloudforms Architecture</title>
<simpara>At YaleNUS we had some discussions around the size of the environment.  Some of the questions that were asked were:</simpara>
<itemizedlist>
<listitem>
<simpara>
How many VMs will be managed in your virtualization environment?
</simpara>
</listitem>
<listitem>
<simpara>
Do you have provisioning templates in place?
</simpara>
</listitem>
<listitem>
<simpara>
Do you have multiple data centers that need to be managed?
</simpara>
</listitem>
<listitem>
<simpara>
Do you have a local NTP server?
</simpara>
</listitem>
<listitem>
<simpara>
Do you have a local DNS or remote DNS service?
</simpara>
</listitem>
<listitem>
<simpara>
Are forward and reverse DNS resolution configured in your environment?
</simpara>
</listitem>
<listitem>
<simpara>
Is there at least 42 GB disk space on target virtualization platform?
</simpara>
</listitem>
</itemizedlist>
<simpara>At Yale NUS the objective of the engagement was to integrate the new Red Hat OpenStack environment and Microsoft AD
environment where they housed their users. Yale NUS would like to implement a Self-service provisioning system using
Cloudforms as the front end where professors and students would only see the VM&#8217;s that they owned.</simpara>
<simpara>Yale uses Microsoft Active Directory (AD) as their directory service implementation. An AD domain controller
authenticates and authorizes Yale NUS users assigning and enforcing security policies. The VMs are used by student,
faculty and other users as well as by the operations group.</simpara>
<simpara>This information gave us a general idea of the size of the environment and allowed us to figure out how to size
the Cloudforms database adequately the first time around. The new appliance does not include the database disk
so with the database appliance we are required to create a separate database disk that would be used by the
Database Appliance.</simpara>
<simpara>In addition, we briefly discussed the overall Cloudforms architecture which included discussions on Zones and
the roles of each appliance.</simpara>
<simpara>There are three main roles for an appliance:
* UI Appliance – allows the user to interact with the Cloudforms user interface
* Worker Appliance – The workhorse which collects all the information from the virtualization environment and sends it to the database to be persisted.
* Database Appliance – one of the most important appliances since it holds all of the data collected by the workers from the virtualization environment.</simpara>
<simpara>It is considered a best practice to separate the appliance responsibilities into these three roles.  Each appliance can be configured with the appropriate roles and tuned to be more performant in the overall environment.</simpara>
<simpara>The Basic Architecture for Cloudforms can be described in a simple Triangle:</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="./images/CF-Triangle.png"/>
  </imageobject>
  <textobject><phrase>./images/CF-Triangle.png</phrase></textobject>
</mediaobject>
</informalfigure>
<simpara>The diagram not only depicts the three main roles for the appliances but also the zones that should be created
to house each type of appliance.  It is best practice to create three zones in a Cloudforms environment:</simpara>
<itemizedlist>
<listitem>
<simpara>
UI Zone
</simpara>
</listitem>
<listitem>
<simpara>
Database Zone
</simpara>
</listitem>
<listitem>
<simpara>
Worker Zone.
</simpara>
</listitem>
</itemizedlist>
<simpara>If we were to draw a box around the triangle this would define a Region.</simpara>
<simpara>A region should have a Database Zone with only one Database Appliance to house all the virtual environment
information. If there are multiple data centers, in different geographic locations, you would replicate the
architecture at each data center. The database appliances can be configured to include the Synchronization
server role to replicate its contents to a main database. Best practice states that you should only
have one database appliance handling the data for one data center.</simpara>
<simpara>The current implementation for YaleNUS only has one appliance but this can easily be extended in future phases
of the project.</simpara>
<section id="_initial_cloudforms_engine_setup">
<title>Initial Cloudforms Engine Setup</title>
<simpara>To manage a <subscript>1500 virtual machines workload in a virtualization environment, multiple appliances should be created
and the roles distributed for better performance and redundancy: 1 DB, 2 Web UI and 4 Workers. Red Hat recommends
5 Workers in the scenario of </subscript>1500 virtual machines, to maintain a 300:1 VM to appliance ratio.</simpara>
<simpara>To increase performance, increase the default 4 vCPUs/6GB RAM appliance configuration to 4 vCPUs/8GB RAM for the
Web UI appliance and 4 vCPUs/8GB RAM for the DB and the Worker appliances.</simpara>
<simpara>With a new CFME appliance the Database is not shipped configured by default. There will need to be a separate
Database disk created outside of the appliance and then connected once the appliance has been started. In this case,
after looking at where the current VM count and number of VM&#8217;s that will be coming over the next few years the
Database can be sized to 150GB. This will allow for growth over the next few years.</simpara>
<simpara>Once started, the appliances need to be configured with basic network settings using the a console in
the OpenStack client. Login as admin/smartvm and press Enter to go to the Advanced Settings menu.  Set Static
Network Configuration, Set Hostname, Set Timezone, Date, and Time. When done entering the settings, select Summary Information to review.</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="./images/CFME-Console-Menu.png"/>
  </imageobject>
  <textobject><phrase>./images/CFME-Console-Menu.png</phrase></textobject>
</mediaobject>
</informalfigure>
</section>
<section id="_cfme_appliance_configuration">
<title>CFME Appliance Configuration</title>
<simpara>To configure the appliance(s), log on to the web server on each appliance at
<ulink url="https://appliance-fqn-name">https://appliance-fqn-name</ulink>, using the default credentials admin/smartvm in
the login screen. Use the Web UI to configure the system(s).</simpara>
<simpara>NTP server for network time synchronization and SMTP server information
(to enable CFME to send event triggered messages) were configured.</simpara>
<simpara>TODO: Screen shots of YaleNUS CFME Engine</simpara>
</section>
<section id="_cfme_appliance_authentication">
<title>CFME Appliance Authentication</title>
<simpara>The default root password (smartvm) should be changed on all appliances as
well as the Web UI Admin password. Here are the steps to change the password:</simpara>
<itemizedlist>
<listitem>
<simpara>
Configure &gt; Configuration.
</simpara>
</listitem>
<listitem>
<simpara>
Select Access Control &gt; Users &gt; Administrator &gt; User Information.
</simpara>
</listitem>
<listitem>
<simpara>
Password/Confirm Password.
</simpara>
</listitem>
<listitem>
<simpara>
Click Save.
</simpara>
</listitem>
</itemizedlist>
<simpara>YaleNUS wants to use LDAP authentication to leverage Yale&#8217;s Microsoft Active Directory infrastructure.</simpara>
<itemizedlist>
<listitem>
<simpara>
Select Configure &gt; Configuration &lt;select zone, server&gt; &gt; Authentication &gt; Mode &gt; LDAPS.
</simpara>
</listitem>
<listitem>
<simpara>
In Configure &gt; Configuration  &lt;select zone, server&gt; &gt; Authentication &gt; LDAP Settings
</simpara>
<itemizedlist>
<listitem>
<simpara>
Enter values for LDAP Host Names, LDAP Port, User Type and User Suffix.
</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</section>
</section>
<section id="_zones">
<title>Zones</title>
<simpara>If YaleNUS decides to add more than one appliance Red hat suggests that the
appliaces are organized the into zones to configure failover and isolate
traffic. A Management System that is discovered by a Server in a specific
zone gets monitored and managed in that zone. All jobs, such as a
SmartState Analysis or VM power operation, dispatched by a Server in a
specific zone can get processed by any CFME appliance assigned to that same
zone.</simpara>
<section id="_yalenus_cfme_ui_appliance">
<title>YaleNUS CFME UI Appliance</title>
<simpara>The UI appliance is the one that allows the user to interact with the
Cloudforms user interface. Access to the UI appliance is achieved by using
your favorite web browser such as Firefox or Google Chrome. The UI Appliance
has a limited set of roles that it needs to support and they are:</simpara>
<itemizedlist>
<listitem>
<simpara>
Notifier
</simpara>
</listitem>
<listitem>
<simpara>
Provider operations
</simpara>
</listitem>
<listitem>
<simpara>
Reporting
</simpara>
</listitem>
<listitem>
<simpara>
Scheduler
</simpara>
</listitem>
<listitem>
<simpara>
User Interface
</simpara>
</listitem>
<listitem>
<simpara>
Web Services
</simpara>
</listitem>
</itemizedlist>
<simpara>YaleNUS has only one appliance in their architecture so ensure that all these
roles are selected.</simpara>
<section id="_yalenus_cfme_appliance_tuning_tip">
<title>YaleNUS CFME Appliance Tuning Tip</title>
<simpara>As mentioned, the Worker Appliances will be doing most of the work collecting
data from the virtualization environments and persisting the data by sending
the information to the Database. The CFME Appliance will be the main appliance
that the user will interact with. We want to make sure that it performs
adequately for the user. A quick tuning for the YaleNUS CFME Appliance is to
change the Count setting on the UI Worker to 2. The Count setting equates to
how many threads the UI appliance will have to service the user interface.</simpara>
<simpara>To change the setting attach to the UI Appliance, Navigate to
Configure&#8594;Configuration first and select the Workers tab. Change the UI
Worker entry count to 2. If you have other UI Appliances in your environment
do ahead and change each of the appliances settings.</simpara>
</section>
</section>
<section id="_yalenus_worker_appliance">
<title>YaleNUS Worker Appliance</title>
<simpara>The Worker Appliance is the work horse which collects all the information
from the virtualization environment and sends it to the database to be
persisted.The server roles that should be configured in the Worker
Appliances are:
* Automation Engine
* C&amp;U Coordinator
* C&amp;U Data Collector
* C&amp;U Data Processor
* Event Monitor
* Notifier
* Provider Inventory
* Provider Operations
* Scheduler
* SmartProxy
* SmartState Analysis
* User Interface
* Web Services</simpara>
<simpara>Notice that in the YaleNUS environment we currently have one appliance. All the
above roles should be checked in that CFME appliance.</simpara>
</section>
<section id="_yalenus_cfme_database_appliance">
<title>YaleNUS CFME Database Appliance</title>
<simpara>The database appliance is one of the most important appliances since it holds
all of the data collected by the workers from the virtualization environment.
The server roles that should be configured in the DB appliances are:</simpara>
<itemizedlist>
<listitem>
<simpara>
User Interface
</simpara>
</listitem>
<listitem>
<simpara>
Web Services
</simpara>
</listitem>
<listitem>
<simpara>
Database Operations
</simpara>
</listitem>
</itemizedlist>
<tip><simpara>The Database Appliance will also be working very hard depending on how
     much data the Worker Appliances are collecting. One of the things that
     needs to be adjusted are the setting for the shared_buffers in the
     postgresql.conf file. Since we will have a dedicated database appliance
     in our environment we will use the DEDICATED CONFIGURATION setting for
     the shared_buffers variable. This will allow the database to be more
     performant.</simpara></tip>
<simpara>Here are the steps to change the settings from our tip above:</simpara>
<itemizedlist>
<listitem>
<simpara>
First ssh to the appliance: ssh <ulink url="mailto:root@database-appliance">root@database-appliance</ulink>
</simpara>
</listitem>
<listitem>
<simpara>
Adjust postfix settings
  [<ulink url="mailto:root@vm-dbappliance-01">root@vm-dbappliance-01</ulink> data]# cd /opt/rh/postgresql92/root/var/lib/pgsql/data
</simpara>
</listitem>
<listitem>
<simpara>
Make a copy of the configuration file.
  [<ulink url="mailto:root@vm-dbappliance-01">root@vm-dbappliance-01</ulink> data]# cp -p postgresql.conf{,.20150601}
</simpara>
</listitem>
<listitem>
<simpara>
Edit the postgresql.conf file:
  [<ulink url="mailto:root@vm-dbappliance-01">root@vm-dbappliance-01</ulink> data]# vi postgresql.conf
</simpara>
</listitem>
<listitem>
<simpara>
Comment #shared_buffers = 128MB  # MIQ Value SHARED CONFIGURATION
</simpara>
</listitem>
<listitem>
<simpara>
Uncomment shared_buffers = 1GB  # MIQ Value DEDICATED CONFIGURATION
</simpara>
<literallayout class="monospaced">[root@vm-dbappliance-01 data]# diff postgresql.conf{.20131021,}</literallayout>
<literallayout class="monospaced">112,113c112,113</literallayout>
<literallayout class="monospaced">&lt; shared_buffers = 128MB  # MIQ Value SHARED CONFIGURATION</literallayout>
<literallayout class="monospaced">&lt; #shared_buffers = 1GB # MIQ Value DEDICATED CONFIGURATION</literallayout>
<literallayout class="monospaced">---</literallayout>
<literallayout class="monospaced">&gt; #shared_buffers = 128MB  # MIQ Value SHARED CONFIGURATION</literallayout>
<literallayout class="monospaced">&gt; shared_buffers = 1GB # MIQ Value DEDICATED CONFIGURATION</literallayout>
</listitem>
</itemizedlist>
<simpara>Note: Services are restarted on the appliance after saving the changes in the database settings.</simpara>
</section>
</section>
<section id="_yalenus_self_service_requirements">
<title>YaleNUS Self-Service Requirements</title>
<simpara>At Yale the objective of the engagement was to integrate the Red Hat OpenStack
virtualization environment and Microsoft AD environment where they house their
user base. YaleNUS would like to implement a Self-service provisioning system
using Cloudforms as the front end where users would only see the VM&#8217;s that
they owned.</simpara>
<simpara>Yale uses Microsoft Active Directory (AD) as their directory service
implemention.  An AD domain controller authenticates and authorizes Yale&#8217;s
users assigning and enforcing security policies.</simpara>
<simpara>There are two ways to use LDAP groups with CFME:
* Create groups with a specific set of names as provided by Cloudforms.
These groups automatically get assigned to a specific role.</simpara>
<itemizedlist>
<listitem>
<simpara>
Assign pre-existing groups from your LDAP server to Cloudforms account role.
</simpara>
</listitem>
</itemizedlist>
<note><simpara>If the LDAP user is not a member of any defined groups, then the user
will be denied access to CFME.</simpara></note>
<simpara>Cloudforms uses role-based access to grant users only the rights they need.
Some built-in roles are provided as part of the product.  User groups are then
assigned to roles and users are assigned to the groups.  Finally, you can
customize the roles to a fine level of detail, or create your own.</simpara>
<simpara>TODO: Document requirements</simpara>
<section id="_yalenus_taxonomy">
<title>YaleNUS Taxonomy</title>
<simpara>During our time at Yale we started discussing briefly the taxonomy of their
User and Group environment.  The purpose of a taxonomy is to attempt to create
an orderly classification of users and groups according to their relationships
in the IT environment and associate these relationships in the CFME Appliance.
The taxonomy will be derived from analysis of usage patterns and information
flow in the YaleNUS environment.</simpara>
<simpara>The discussions were very brief due to the data center move activities.
Nonetheless the goal of these discussions around User and Group environment is
to provide YaleNUS with the following features:</simpara>
<itemizedlist>
<listitem>
<simpara>
A view of how their users will be organized in the Microsoft AD environment.
</simpara>
</listitem>
<listitem>
<simpara>
Enable self-service and accelerate the delivery of IT services by giving
  Students/Faculty direct access to customizable service catalogs and virtual
  assets through role-based access.
</simpara>
</listitem>
<listitem>
<simpara>
Provide Infrastructure-as-a-Service (IaaS) to reduce provisioning and
  approval times.
</simpara>
</listitem>
<listitem>
<simpara>
VMs, complex services, and multi-tier applications can all be requested and
  deployed automatically based on enforceable policies.
</simpara>
</listitem>
<listitem>
<simpara>
When we build the taxonomy we need to think about the following:
</simpara>
<itemizedlist>
<listitem>
<simpara>
The taxonomy will be hierarchical. The classification of users will be
   multilevel, representing hierarchical relationships between their roles
   within a defined scope and context.
</simpara>
</listitem>
<listitem>
<simpara>
The taxonomy will be used to categorize roles that will define access to
   different Virtual Machine templates and instances.
</simpara>
</listitem>
<listitem>
<simpara>
An authorized user should be given a hierarchical listing of categories
   from which he or she can assign labels to content items (tagging).
   The assigned category should then be reviewed as part of the assessment and
   approval process.
</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</section>
<section id="_defined_user_groups">
<title>Defined User Groups</title>
<simpara>For YaleNUS we have defined the following groups:
* YaleNUS-Admin - Basic YaleNUS Administrator group.
  This group will have superuser capabilities.
* YaleNUS-&lt;Project&gt; - User group to be associated with their current
  project.
* YaleNUS-&lt;Project&gt;-Admin - This is the Project Administrator
  i.e. Group for Professors.</simpara>
<note><simpara>Red Hat Consulting and YaleNUS need to have discussions around the
      requirements around User Groups and Roles.</simpara></note>
</section>
<section id="_defined_roles">
<title>Defined Roles</title>
<simpara>As part of the Yale&#8217;s business requirements document the following AD groups
will need to be defined at YaleNUS:</simpara>
<itemizedlist>
<listitem>
<simpara>
YaleNUS System Administrator group = (YaleNUS-Admin)
</simpara>
</listitem>
<listitem>
<simpara>
YaleNUS Projects = (YaleNUS-History, YaleNUS-Geology, ??)
</simpara>
</listitem>
<listitem>
<simpara>
YaleNUS Project Admins = (YaleNUS-History-Admin, YaleNUS-Geology-Admin, ??)
</simpara>
</listitem>
</itemizedlist>
<note><simpara>Red Hat Consulting and YaleNUS need to have discussions around the
      requirements around User Groups and Roles.</simpara></note>
</section>
</section>
<section id="_yalenus_network_information">
<title>YaleNUS Network Information</title>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<?dbhtml table-width="100%"?>
<?dbfo table-width="100%"?>
<?dblatex table-width="100%"?>
<tgroup cols="5">
<colspec colname="col_1" colwidth="85*"/>
<colspec colname="col_2" colwidth="85*"/>
<colspec colname="col_3" colwidth="85*"/>
<colspec colname="col_4" colwidth="85*"/>
<colspec colname="col_5" colwidth="85*"/>
<thead>
<row>
<entry align="left" valign="top"> Name </entry>
<entry align="left" valign="top"> VM? </entry>
<entry align="left" valign="top"> On hosts </entry>
<entry align="left" valign="top"> Special attributes </entry>
<entry align="left" valign="top"> Notes</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara>CFME Engine</simpara></entry>
<entry align="left" valign="top"><simpara>Y</simpara></entry>
<entry align="left" valign="top"><simpara></simpara></entry>
<entry align="left" valign="top"><simpara></simpara></entry>
<entry align="left" valign="top"><simpara>The default CFME Engine</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
</section>
</section>
<section id="_yalenus_amazon_implementation_details">
<title>YaleNUS Amazon Implementation Details</title>
<section id="_yalenus_aws_service_dialog">
<title>YaleNUS AWS Service Dialog</title>
</section>
</section>
<section id="_openstack_deployment">
<title>OpenStack Deployment</title>
<section id="_overview_2">
<title>Overview</title>
<simpara>Overview of YaleNUS OpenStack environment</simpara>
<section id="_pre_requisites_2">
<title>Pre-requisites</title>
<itemizedlist>
<listitem>
<simpara>
List pre-requisites
</simpara>
</listitem>
<listitem>
<simpara>
Server Racked, Stacked and Cabled
</simpara>
</listitem>
<listitem>
<simpara>
Switch configuration completed
</simpara>
</listitem>
</itemizedlist>
</section>
<section id="_versions">
<title>Versions</title>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<?dbhtml table-width="100%"?>
<?dbfo table-width="100%"?>
<?dblatex table-width="100%"?>
<tgroup cols="2">
<colspec colname="col_1" colwidth="213*"/>
<colspec colname="col_2" colwidth="213*"/>
<tbody>
<row>
<entry align="left" valign="top"><simpara>Enovance Spinal Stack OpenStack Version</simpara></entry>
<entry align="left" valign="top"><simpara>Juno Version</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
</section>
<section id="_architecture">
<title>Architecture</title>
<itemizedlist>
<listitem>
<simpara>
1x Management Node
</simpara>
</listitem>
<listitem>
<simpara>
3x Nodes
</simpara>
</listitem>
<listitem>
<simpara>
3x Controllers
</simpara>
</listitem>
<listitem>
<simpara>
2 Load Balancers
</simpara>
</listitem>
<listitem>
<simpara>
4x8 Nova Nodes
</simpara>
</listitem>
<listitem>
<simpara>
6 Storage Nodes
</simpara>
</listitem>
</itemizedlist>
<simpara>Below is a image of the white board depicting the architecture for OpenStack
at YaleNUS.</simpara>
<informalfigure>
<mediaobject>
  <imageobject>
  <imagedata fileref="./images/OpenStack/YaleNUS-OpenStack-Architecture2.jpg"/>
  </imageobject>
  <textobject><phrase>./images/OpenStack/YaleNUS-OpenStack-Architecture2.jpg</phrase></textobject>
</mediaobject>
</informalfigure>
<section id="_management_load_balancer_and_controller_hardware">
<title>Management, Load Balancer and Controller Hardware</title>
<screen>Dell PowerEdge R720

Components:
   1 PowerEdge R720/R720xd Motherboard TPM
   1 Intel Xeon E5-2650v2 2.6GHz, 20M Cache, 8.0GT/s QPI, Turbo, HT, 8C, 95W, Max Mem 1866MHz
   1 Intel Xeon E5-2650v2 2.6GHz, 20M Cache, 8.0GT/s QPI, Turbo, HT, 8C, 95W, Max Mem 1866MHz,2nd Proc
   1 3.5-Inch Chassis for PowerEdge R720
   1 Risers with up to 6, x8 PCIe Slots + 1, x16 PCIe Slot
   1 Electronic System Documentation and OpenManage DVD Kit for R720
   1 Bezel
   1 DIMM Blanks for Systems with 2 Processors
   1 1600 MHz RDIMMS
   1 Performance Optimized
   8 16GB RDIMM, 1600Mhz, Low Volt, Dual Rank, x4 Bandwidth
   4 2TB 7.2K RPM Near Line, 6Gbps SAS 3.5" Hot Plug Hard Drive
   1 PERC H710 Integrated RAID Controller, 512MB NV Cache, Mini-Type
   2 Heat Sink for PowerEdge R720 and R720xd
   1 12.7 Tray DVD ROM
   1 Dual, Hot-plug, Redundant Power Supply (1+1), 750W
   2 SFP+, Short Range Optical Tranceiver, LC Connector, 10Gb and 1Gb compatible
   1 No Monitor
   2 Long Jumper Cord, C13-C14,4m,12a (APCC)
   1 Broadcom 57800S 2x10Gb DA/SFP+ + 2x1Gb BT Network Daughter Card(Exclude SFP+ Optics/DA Cables)
   1 2U Cable Management Arm
   1 ReadyRails 2U Sliding Rails
   1 C5 - RAID 10 for H710p/H710/H310 (4-16 HDDs in pairs)
   1 iDRAC7 Enterprise</screen>
<simpara>&gt;&gt;&gt;&gt;&gt;&gt;&gt; claudiol-yalenus</simpara>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<?dbhtml table-width="100%"?>
<?dbfo table-width="100%"?>
<?dblatex table-width="100%"?>
<tgroup cols="2">
<colspec colname="col_1" colwidth="213*"/>
<colspec colname="col_2" colwidth="213*"/>
<tbody>
<row>
<entry align="left" valign="top"><simpara>RAM</simpara></entry>
<entry align="left" valign="top"><simpara>128 GB</simpara></entry>
</row>
<row>
<entry align="left" valign="top"><simpara>OS Disk</simpara></entry>
<entry align="left" valign="top"><simpara>2x 300GB</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
</section>
</section>
<section id="_yale_nus_cloud_existing_hardware_for_compute_nodes">
<title>Yale-NUS Cloud – Existing hardware for compute nodes</title>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<?dbhtml table-width="100%"?>
<?dbfo table-width="100%"?>
<?dblatex table-width="100%"?>
<tgroup cols="2">
<colspec colname="col_1" colwidth="213*"/>
<colspec colname="col_2" colwidth="213*"/>
<thead>
<row>
<entry align="left" valign="top"> Item </entry>
<entry align="left" valign="top"> Qty</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left" valign="top"><simpara></simpara></entry>
<entry align="left" valign="top"><simpara>NOVATTE R2608 multi-node server (Option 3 with Dual</simpara></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<section id="_novatte_r2608_server_hardware_details">
<title>NOVATTE R2608 Server Hardware Details</title>
<screen>* 10GBASE-T ports per node via PCI-E adapter), comprising:

System:
** (4) node 2U Rackmount Server,
** (12)x 3.5" or (24)x 2.5" drive bays total,
** (2) High efficiency PSUs (platinum level)

Each node supports:
* (2) Intel® Xeon® processor E5-2600/ E5-2600 v2 product family,
* (16) DDR3 1066/1333/1600/1866 MHz RDIMM slots,
* (6) 2.5" 2.1.1. or (3) 3.5" hot-plug HDDs and (1) optional USB Flash Module,
* (1) PCIe x16 G3 riser slot for low-profile card,
* (2) Intel® I350 GbE RJ45 ports,
* (1) Dedicated 10/100 BASE-T RJ45 management port,
* (2) USB 2.0 ports per node,
* (1) VGA port per node,
* (1) RS232 serial port
* Processors per node: (2) Intel Xeon 8 Core 2.7/ 20M
* 8.0GT/sec (E5-2680)
* Memory per node: 128GB by 16GB DDR3-1600 ECC REG modules
* SSD per node: (2)120GB Intel DCS3500 SATA, MLC
* 10GbE adapter: Intel dual X540 10GbE BASE-T RJ45 ports</screen>
</section>
</section>
<section id="_networks">
<title>Networks</title>
<informaltable
frame="all"
rowsep="1" colsep="1"
>
<?dbhtml table-width="100%"?>
<?dbfo table-width="100%"?>
<?dblatex table-width="100%"?>
<tgroup cols="5">
<colspec colname="col_1" colwidth="85*"/>
<colspec colname="col_2" colwidth="85*"/>
<colspec colname="col_3" colwidth="85*"/>
<colspec colname="col_4" colwidth="85*"/>
<colspec colname="col_5" colwidth="85*"/>
<thead>
<row>
<entry align="left" valign="top"> Name </entry>
<entry align="left" valign="top"> VM? </entry>
<entry align="left" valign="top"> On hosts </entry>
<entry align="left" valign="top"> Special attributes </entry>
<entry align="left" valign="top"> Notes</entry>
</row>
</thead>
<tbody>
</tbody>
</tgroup>
</informaltable>
</section>
<section id="_openstack_templates">
<title>OpenStack Templates</title>
<simpara>Template creation was explained and the customer was able to create
their own templates from VMs. Yale NUS will provide OpenStack templates
for provisioning purposes.</simpara>
</section>
<section id="_create_vm">
<title>Create VM</title>
<simpara>For demonstration purposes, two VMs were created, one from the RHEL 6
DVD ISO and one from the RHEL 7 ISO.  The customer also was able to
create virtual machines including demonstrating their ability to
provision.</simpara>
<simpara><?asciidoc-pagebreak?></simpara>
</section>
</section>
</section>
<section id="_appendix_a_anchor_id_yalenus_rolebaseaccess_xreflabel_yalenus_rolebaseaccess_yalenus_basic_role_base_access">
<title>Appendix A - <anchor id="YaleNUS-RoleBaseAccess" xreflabel="[YaleNUS-RoleBaseAccess]"/>YaleNUS Basic Role Base Access</title>
<simpara>TODO: Add screenshots</simpara>
<simpara><?asciidoc-pagebreak?></simpara>
<simpara>The first screen for YaleNUS student for AWS</simpara>
</section>
<section id="_appendix_b_additional_resources">
<title>Appendix B - Additional Resources</title>
<section id="_training">
<title>Training</title>
<simpara>For a solid grounding in the products deployed, Red Hat recommends staff
be designated to attend the following training classes:</simpara>
<itemizedlist>
<listitem>
<simpara>
<ulink url="http://www.redhat.com/en/services/training/cl220-red-hat-cloudforms-hybrid-cloud-management">http://www.redhat.com/en/services/training/cl220-red-hat-cloudforms-hybrid-cloud-management</ulink>
</simpara>
</listitem>
</itemizedlist>
<simpara>&#8212;&#8201;CL220 Red Hat CloudForms Hybrid Cloud Management</simpara>
<simpara>Red Hat CloudForms Hybrid Cloud Management teaches you how to perform an initial configuration and setup of Red Hat CloudForms.</simpara>
<simpara>This course can also help you in your preparation for the Red Hat Certificate of Expertise in Hybrid Cloud Management exam (EX220).</simpara>
</section>
<section id="_course_content_summary">
<title>Course content summary</title>
<itemizedlist>
<listitem>
<simpara>
Perform initial configuration of CloudForms appliance
</simpara>
</listitem>
<listitem>
<simpara>
Deploy virtual machines
</simpara>
</listitem>
<listitem>
<simpara>
Perform policy-based management
</simpara>
</listitem>
<listitem>
<simpara>
Customize a dashboard
</simpara>
</listitem>
<listitem>
<simpara>
Create a catalog
</simpara>
</listitem>
<listitem>
<simpara>
Provision services
</simpara>
</listitem>
<listitem>
<simpara>
Analyze timelines and events
</simpara>
</listitem>
<listitem>
<simpara>
Run automations
</simpara>
</listitem>
</itemizedlist>
</section>
<section id="_documentation">
<title>Documentation</title>
</section>
</section>
</article>
